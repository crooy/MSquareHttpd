


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Actors (Java) &mdash; Akka Documentation</title>
    <link rel="stylesheet" href="../_static/akka.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/print.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/theme_extras.js"></script>
    <link rel="top" title="Akka Documentation" href="../index.html" />
    <link rel="up" title="Java API" href="index.html" />
    <link rel="next" title="Typed Actors (Java)" href="typed-actors.html" />
    <link rel="prev" title="Java API" href="index.html" /> 
  </head>
  <body>
      <div class="header"><a href="../index.html"><img class="leftlogo" src="../_static/logo.png" alt="Logo"/></a><h1 class="heading"><a href="../index.html"><span>Akka Documentation</span></a></h1>
       <h2 class="heading"><a href="../index.html"><span>Version 1.2</span></a></h2>
       <h2 class="rightheading"><span><a href="http://akka.io/docs/akka/snapshot/Akka.pdf">PDF</a></span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="index.html">Java API</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="typed-actors.html">Typed Actors (Java)</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="actors-java">
<span id="untyped-actors-java"></span><h1>Actors (Java)<a class="headerlink" href="#actors-java" title="Permalink to this headline">¶</a></h1>
<div class="sidebar">
<p class="first sidebar-title">Contents</p>
<div class="contents local last topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#defining-an-actor-class" id="id1">Defining an Actor class</a><ul>
<li><a class="reference internal" href="#creating-actors" id="id2">Creating Actors</a></li>
<li><a class="reference internal" href="#creating-actors-with-non-default-constructor" id="id3">Creating Actors with non-default constructor</a></li>
</ul>
</li>
<li><a class="reference internal" href="#untypedactor-context" id="id4">UntypedActor context</a></li>
<li><a class="reference internal" href="#identifying-actors" id="id5">Identifying Actors</a></li>
<li><a class="reference internal" href="#messages-and-immutability" id="id6">Messages and immutability</a></li>
<li><a class="reference internal" href="#send-messages" id="id7">Send messages</a><ul>
<li><a class="reference internal" href="#fire-forget" id="id8">Fire-forget</a></li>
<li><a class="reference internal" href="#send-and-receive-eventually" id="id9">Send-And-Receive-Eventually</a></li>
<li><a class="reference internal" href="#send-and-receive-future" id="id10">Send-And-Receive-Future</a></li>
<li><a class="reference internal" href="#forward-message" id="id11">Forward message</a></li>
</ul>
</li>
<li><a class="reference internal" href="#receive-messages" id="id12">Receive messages</a></li>
<li><a class="reference internal" href="#reply-to-messages" id="id13">Reply to messages</a><ul>
<li><a class="reference internal" href="#reply-using-the-channel" id="id14">Reply using the channel</a></li>
<li><a class="reference internal" href="#reply-using-the-replysafe-and-replyunsafe-methods" id="id15">Reply using the &#8216;replySafe&#8217; and &#8216;replyUnsafe&#8217; methods</a></li>
<li><a class="reference internal" href="#summary-of-reply-semantics-and-options" id="id16">Summary of reply semantics and options</a></li>
</ul>
</li>
<li><a class="reference internal" href="#starting-actors" id="id17">Starting actors</a></li>
<li><a class="reference internal" href="#stopping-actors" id="id18">Stopping actors</a></li>
<li><a class="reference internal" href="#poisonpill" id="id19">PoisonPill</a></li>
<li><a class="reference internal" href="#killing-an-actor" id="id20">Killing an Actor</a></li>
<li><a class="reference internal" href="#actor-life-cycle" id="id21">Actor life-cycle</a></li>
</ul>
</div>
</div>
<p>Module stability: <strong>SOLID</strong></p>
<p>The <a class="reference external" href="http://en.wikipedia.org/wiki/Actor_model">Actor Model</a> provides a higher level of abstraction for writing concurrent and distributed systems. It alleviates the developer from having to deal with explicit locking and thread management, making it easier to write correct concurrent and parallel systems. Actors were defined in the 1973 paper by Carl Hewitt but have been popularized by the Erlang language, and used for example at Ericsson with great success to build highly concurrent and reliable telecom systems.</p>
<div class="section" id="defining-an-actor-class">
<h2><a class="toc-backref" href="#id1">Defining an Actor class</a><a class="headerlink" href="#defining-an-actor-class" title="Permalink to this headline">¶</a></h2>
<p>Actors in Java are created either by extending the &#8216;UntypedActor&#8217; class and implementing the &#8216;onReceive&#8217; method. This method takes the message as a parameter.</p>
<p>Here is an example:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">akka.actor.UntypedActor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">akka.event.EventHandler</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleUntypedActor</span> <span class="kd">extends</span> <span class="n">UntypedActor</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onReceive</span><span class="o">(</span><span class="n">Object</span> <span class="n">message</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">message</span> <span class="k">instanceof</span> <span class="n">String</span><span class="o">)</span>
      <span class="n">EventHandler</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">&quot;Received String message: %s&quot;</span><span class="o">,</span>
        <span class="n">message</span><span class="o">));</span>
    <span class="k">else</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">&quot;Unknown message: &quot;</span> <span class="o">+</span> <span class="n">message</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="section" id="creating-actors">
<h3><a class="toc-backref" href="#id2">Creating Actors</a><a class="headerlink" href="#creating-actors" title="Permalink to this headline">¶</a></h3>
<p>Creating an Actor is done using the &#8216;akka.actor.Actors.actorOf&#8217; factory method. This method returns a reference to the UntypedActor&#8217;s ActorRef. This &#8216;ActorRef&#8217; is an immutable serializable reference that you should use to communicate with the actor, send messages, link to it etc. This reference also functions as the context for the actor and holds run-time type information such as sender of the last message,</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">ActorRef</span> <span class="n">myActor</span> <span class="o">=</span> <span class="n">Actors</span><span class="o">.</span><span class="na">actorOf</span><span class="o">(</span><span class="n">SampleUntypedActor</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="n">myActor</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
</pre></div>
</div>
<p>Normally you would want to import the &#8216;actorOf&#8217; method like this:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">static</span> <span class="n">akka</span><span class="o">.</span><span class="na">actor</span><span class="o">.</span><span class="na">Actors</span><span class="o">.*;</span>
<span class="n">ActorRef</span> <span class="n">myActor</span> <span class="o">=</span> <span class="n">actorOf</span><span class="o">(</span><span class="n">SampleUntypedActor</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</pre></div>
</div>
<p>To avoid prefix it with &#8216;Actors&#8217; every time you use it.</p>
<p>You can also create &amp; start the actor in one statement:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">ActorRef</span> <span class="n">myActor</span> <span class="o">=</span> <span class="n">actorOf</span><span class="o">(</span><span class="n">SampleUntypedActor</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">start</span><span class="o">();</span>
</pre></div>
</div>
<p>The call to &#8216;actorOf&#8217; returns an instance of &#8216;ActorRef&#8217;. This is a handle to the &#8216;UntypedActor&#8217; instance which you can use to interact with the Actor, like send messages to it etc. more on this shortly. The &#8216;ActorRef&#8217; is immutable and has a one to one relationship with the Actor it represents. The &#8216;ActorRef&#8217; is also serializable and network-aware. This means that you can serialize it, send it over the wire and use it on a remote host and it will still be representing the same Actor on the original node, across the network.</p>
</div>
<div class="section" id="creating-actors-with-non-default-constructor">
<h3><a class="toc-backref" href="#id3">Creating Actors with non-default constructor</a><a class="headerlink" href="#creating-actors-with-non-default-constructor" title="Permalink to this headline">¶</a></h3>
<p>If your UntypedActor has a constructor that takes parameters then you can&#8217;t create it using &#8216;actorOf(clazz)&#8217;. Instead you can use a variant of &#8216;actorOf&#8217; that takes an instance of an &#8216;UntypedActorFactory&#8217; in which you can create the Actor in any way you like. If you use this method then you to make sure that no one can get a reference to the actor instance. If they can get a reference it then they can touch state directly in bypass the whole actor dispatching mechanism and create race conditions which can lead to corrupt data.</p>
<p>Here is an example:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">ActorRef</span> <span class="n">actor</span> <span class="o">=</span> <span class="n">actorOf</span><span class="o">(</span><span class="k">new</span> <span class="n">UntypedActorFactory</span><span class="o">()</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="n">UntypedActor</span> <span class="nf">create</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nf">MyUntypedActor</span><span class="o">(</span><span class="s">&quot;service:name&quot;</span><span class="o">,</span> <span class="mi">5</span><span class="o">);</span>
   <span class="o">}</span>
<span class="o">});</span>
</pre></div>
</div>
<p>This way of creating the Actor is also great for integrating with Dependency Injection (DI) frameworks like Guice or Spring.</p>
</div>
</div>
<div class="section" id="untypedactor-context">
<h2><a class="toc-backref" href="#id4">UntypedActor context</a><a class="headerlink" href="#untypedactor-context" title="Permalink to this headline">¶</a></h2>
<p>The UntypedActor base class contains almost no member fields or methods to invoke. It only has the &#8216;onReceive(Object message)&#8217; method, which is defining the Actor&#8217;s message handler, and some life-cycle callbacks that you can choose to implement:
## preStart
## postStop
## preRestart
## postRestart</p>
<p>Most of the API is in the UnypedActorRef a reference for the actor. This reference is available in the &#8216;getContext()&#8217; method in the UntypedActor (or you can use its alias, the &#8216;context()&#8217; method, if you prefer. Here, for example, you find methods to reply to messages, send yourself messages, define timeouts, fault tolerance etc., start and stop etc.</p>
</div>
<div class="section" id="identifying-actors">
<h2><a class="toc-backref" href="#id5">Identifying Actors</a><a class="headerlink" href="#identifying-actors" title="Permalink to this headline">¶</a></h2>
<p>Each ActorRef has two methods:
* getContext().getUuid();
* getContext().getId();</p>
<p>The difference is that the &#8216;uuid&#8217; is generated by the runtime, guaranteed to be unique and can&#8217;t be modified. While the &#8216;id&#8217; can be set by the user (using &#8216;getContext().setId(...)&#8217;, and defaults to Actor class name. You can retrieve Actors by both UUID and ID using the &#8216;ActorRegistry&#8217;, see the section further down for details.</p>
</div>
<div class="section" id="messages-and-immutability">
<h2><a class="toc-backref" href="#id6">Messages and immutability</a><a class="headerlink" href="#messages-and-immutability" title="Permalink to this headline">¶</a></h2>
<p><strong>IMPORTANT</strong>: Messages can be any kind of object but have to be immutable. Akka can’t enforce immutability (yet) so this has to be by convention.</p>
</div>
<div class="section" id="send-messages">
<h2><a class="toc-backref" href="#id7">Send messages</a><a class="headerlink" href="#send-messages" title="Permalink to this headline">¶</a></h2>
<p>Messages are sent to an Actor through one of the &#8216;send&#8217; methods.
* &#8216;tell&#8217; means “fire-and-forget”, e.g. send a message asynchronously and return immediately.
* &#8216;sendRequestReply&#8217; means “send-and-reply-eventually”, e.g. send a message asynchronously and wait for a reply through a Future. Here you can specify a timeout. Using timeouts is very important. If no timeout is specified then the actor’s default timeout (set by the &#8216;getContext().setTimeout(..)&#8217; method in the &#8216;ActorRef&#8217;) is used. This method throws an &#8216;ActorTimeoutException&#8217; if the call timed out.
* &#8216;sendRequestReplyFuture&#8217; sends a message asynchronously and returns a &#8216;Future&#8217;.</p>
<p>In all these methods you have the option of passing along your &#8216;ActorRef&#8217; context variable. Make it a practice of doing so because it will allow the receiver actors to be able to respond to your message, since the sender reference is sent along with the message.</p>
<div class="section" id="fire-forget">
<h3><a class="toc-backref" href="#id8">Fire-forget</a><a class="headerlink" href="#fire-forget" title="Permalink to this headline">¶</a></h3>
<p>This is the preferred way of sending messages. No blocking waiting for a message. Give best concurrency and scalability characteristics.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">actor</span><span class="o">.</span><span class="na">tell</span><span class="o">(</span><span class="s">&quot;Hello&quot;</span><span class="o">);</span>
</pre></div>
</div>
<p>Or with the sender reference passed along:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">actor</span><span class="o">.</span><span class="na">tell</span><span class="o">(</span><span class="s">&quot;Hello&quot;</span><span class="o">,</span> <span class="n">getContext</span><span class="o">());</span>
</pre></div>
</div>
<p>If invoked from within an Actor, then the sending actor reference will be implicitly passed along with the message and available to the receiving Actor in its &#8216;getContext().getSender();&#8217; method. He can use this to reply to the original sender or use the &#8216;getContext().reply(message);&#8217; method.</p>
<p>If invoked from an instance that is <strong>not</strong> an Actor there will be no implicit sender passed along the message and you will get an &#8216;IllegalStateException&#8217; if you call &#8216;getContext().reply(..)&#8217;.</p>
</div>
<div class="section" id="send-and-receive-eventually">
<h3><a class="toc-backref" href="#id9">Send-And-Receive-Eventually</a><a class="headerlink" href="#send-and-receive-eventually" title="Permalink to this headline">¶</a></h3>
<p>Using &#8216;sendRequestReply&#8217; will send a message to the receiving Actor asynchronously but it will wait for a reply on a &#8216;Future&#8217;, blocking the sender Actor until either:</p>
<ul class="simple">
<li>A reply is received, or</li>
<li>The Future times out and an &#8216;ActorTimeoutException&#8217; is thrown.</li>
</ul>
<p>You can pass an explicit time-out to the &#8216;sendRequestReply&#8217; method and if none is specified then the default time-out defined in the sender Actor will be used.</p>
<p>Here are some examples:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">UntypedActorRef</span> <span class="n">actorRef</span> <span class="o">=</span> <span class="o">...</span>

<span class="k">try</span> <span class="o">{</span>
  <span class="n">Object</span> <span class="n">result</span> <span class="o">=</span> <span class="n">actorRef</span><span class="o">.</span><span class="na">sendRequestReply</span><span class="o">(</span><span class="s">&quot;Hello&quot;</span><span class="o">,</span> <span class="n">getContext</span><span class="o">(),</span> <span class="mi">1000</span><span class="o">);</span>
  <span class="o">...</span> <span class="c1">// handle reply</span>
<span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">ActorTimeoutException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
  <span class="o">...</span> <span class="c1">// handle timeout</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="send-and-receive-future">
<h3><a class="toc-backref" href="#id10">Send-And-Receive-Future</a><a class="headerlink" href="#send-and-receive-future" title="Permalink to this headline">¶</a></h3>
<p>Using &#8216;sendRequestReplyFuture&#8217; will send a message to the receiving Actor asynchronously and will immediately return a &#8216;Future&#8217;.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">Future</span> <span class="n">future</span> <span class="o">=</span> <span class="n">actorRef</span><span class="o">.</span><span class="na">sendRequestReplyFuture</span><span class="o">(</span><span class="s">&quot;Hello&quot;</span><span class="o">,</span> <span class="n">getContext</span><span class="o">(),</span> <span class="mi">1000</span><span class="o">);</span>
</pre></div>
</div>
<p>The &#8216;Future&#8217; interface looks like this:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kd">interface</span> <span class="nc">Future</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="kt">void</span> <span class="nf">await</span><span class="o">();</span>
  <span class="kt">void</span> <span class="nf">awaitBlocking</span><span class="o">();</span>
  <span class="kt">boolean</span> <span class="nf">isCompleted</span><span class="o">();</span>
  <span class="kt">boolean</span> <span class="nf">isExpired</span><span class="o">();</span>
  <span class="kt">long</span> <span class="nf">timeoutInNanos</span><span class="o">();</span>
  <span class="n">Option</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">result</span><span class="o">();</span>
  <span class="n">Option</span><span class="o">&lt;</span><span class="n">Throwable</span><span class="o">&gt;</span> <span class="n">exception</span><span class="o">();</span>
  <span class="n">Future</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">onComplete</span><span class="o">(</span><span class="n">Procedure</span><span class="o">&lt;</span><span class="n">Future</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span> <span class="n">procedure</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</div>
<p>So the normal way of working with futures is something like this:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">Future</span> <span class="n">future</span> <span class="o">=</span> <span class="n">actorRef</span><span class="o">.</span><span class="na">sendRequestReplyFuture</span><span class="o">(</span><span class="s">&quot;Hello&quot;</span><span class="o">,</span> <span class="n">getContext</span><span class="o">(),</span> <span class="mi">1000</span><span class="o">);</span>
<span class="n">future</span><span class="o">.</span><span class="na">await</span><span class="o">();</span>
<span class="k">if</span> <span class="o">(</span><span class="n">future</span><span class="o">.</span><span class="na">isCompleted</span><span class="o">())</span> <span class="o">{</span>
  <span class="n">Option</span> <span class="n">resultOption</span> <span class="o">=</span> <span class="n">future</span><span class="o">.</span><span class="na">result</span><span class="o">();</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">resultOption</span><span class="o">.</span><span class="na">isDefined</span><span class="o">())</span> <span class="o">{</span>
    <span class="n">Object</span> <span class="n">result</span> <span class="o">=</span> <span class="n">resultOption</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
    <span class="o">...</span>
  <span class="o">}</span>
  <span class="o">...</span> <span class="c1">// whatever</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The &#8216;onComplete&#8217; callback can be used to register a callback to get a notification when the Future completes. Gives you a way to avoid blocking.</p>
</div>
<div class="section" id="forward-message">
<h3><a class="toc-backref" href="#id11">Forward message</a><a class="headerlink" href="#forward-message" title="Permalink to this headline">¶</a></h3>
<p>You can forward a message from one actor to another. This means that the original sender address/reference is maintained even though the message is going through a &#8216;mediator&#8217;. This can be useful when writing actors that work as routers, load-balancers, replicators etc. You need to pass along your ActorRef context variable as well.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">getContext</span><span class="o">().</span><span class="na">forward</span><span class="o">(</span><span class="n">message</span><span class="o">,</span> <span class="n">getContext</span><span class="o">());</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="receive-messages">
<h2><a class="toc-backref" href="#id12">Receive messages</a><a class="headerlink" href="#receive-messages" title="Permalink to this headline">¶</a></h2>
<p>When an actor receives a message it is passed into the &#8216;onReceive&#8217; method, this is an abstract method on the &#8216;UntypedActor&#8217; base class that needs to be defined.</p>
<p>Here is an example:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleUntypedActor</span> <span class="kd">extends</span> <span class="n">UntypedActor</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onReceive</span><span class="o">(</span><span class="n">Object</span> <span class="n">message</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">message</span> <span class="k">instanceof</span> <span class="n">String</span><span class="o">)</span>
      <span class="n">EventHandler</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">&quot;Received String message: %s&quot;</span><span class="o">,</span> <span class="n">message</span><span class="o">));</span>
    <span class="k">else</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">&quot;Unknown message: &quot;</span> <span class="o">+</span> <span class="n">message</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="reply-to-messages">
<h2><a class="toc-backref" href="#id13">Reply to messages</a><a class="headerlink" href="#reply-to-messages" title="Permalink to this headline">¶</a></h2>
<div class="section" id="reply-using-the-channel">
<h3><a class="toc-backref" href="#id14">Reply using the channel</a><a class="headerlink" href="#reply-using-the-channel" title="Permalink to this headline">¶</a></h3>
<p>If you want to have a handle to an object to whom you can reply to the message, you can use the Channel abstraction.
Simply call getContext().channel() and then you can forward that to others, store it away or otherwise until you want to reply,
which you do by Channel.tell(msg)</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kd">public</span> <span class="kt">void</span> <span class="nf">onReceive</span><span class="o">(</span><span class="n">Object</span> <span class="n">message</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">message</span> <span class="k">instanceof</span> <span class="n">String</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">String</span> <span class="n">msg</span> <span class="o">=</span> <span class="o">(</span><span class="n">String</span><span class="o">)</span><span class="n">message</span><span class="o">;</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">msg</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">&quot;Hello&quot;</span><span class="o">))</span> <span class="o">{</span>
      <span class="c1">// Reply to original sender of message using the channel</span>
      <span class="n">getContext</span><span class="o">().</span><span class="na">channel</span><span class="o">().</span><span class="na">tryTell</span><span class="o">(</span><span class="n">msg</span> <span class="o">+</span> <span class="s">&quot; from &quot;</span> <span class="o">+</span> <span class="n">getContext</span><span class="o">().</span><span class="na">getUuid</span><span class="o">());</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>We recommend that you as first choice use the channel abstraction instead of the other ways described in the following sections.</p>
</div>
<div class="section" id="reply-using-the-replysafe-and-replyunsafe-methods">
<h3><a class="toc-backref" href="#id15">Reply using the &#8216;replySafe&#8217; and &#8216;replyUnsafe&#8217; methods</a><a class="headerlink" href="#reply-using-the-replysafe-and-replyunsafe-methods" title="Permalink to this headline">¶</a></h3>
<p>If you want to send a message back to the original sender of the message you just received then you can use the &#8216;getContext().replyUnsafe(..)&#8217; method.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kd">public</span> <span class="kt">void</span> <span class="nf">onReceive</span><span class="o">(</span><span class="n">Object</span> <span class="n">message</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">message</span> <span class="k">instanceof</span> <span class="n">String</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">String</span> <span class="n">msg</span> <span class="o">=</span> <span class="o">(</span><span class="n">String</span><span class="o">)</span><span class="n">message</span><span class="o">;</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">msg</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">&quot;Hello&quot;</span><span class="o">))</span> <span class="o">{</span>
      <span class="c1">// Reply to original sender of message using the &#39;replyUnsafe&#39; method</span>
      <span class="n">getContext</span><span class="o">().</span><span class="na">replyUnsafe</span><span class="o">(</span><span class="n">msg</span> <span class="o">+</span> <span class="s">&quot; from &quot;</span> <span class="o">+</span> <span class="n">getContext</span><span class="o">().</span><span class="na">getUuid</span><span class="o">());</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>In this case we will a reply back to the Actor that sent the message.</p>
<p>The &#8216;replyUnsafe&#8217; method throws an &#8216;IllegalStateException&#8217; if unable to determine what to reply to, e.g. the sender has not been passed along with the message when invoking one of &#8216;send*&#8217; methods. You can also use the more forgiving &#8216;replySafe&#8217; method which returns &#8216;true&#8217; if reply was sent, and &#8216;false&#8217; if unable to determine what to reply to.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kd">public</span> <span class="kt">void</span> <span class="nf">onReceive</span><span class="o">(</span><span class="n">Object</span> <span class="n">message</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">message</span> <span class="k">instanceof</span> <span class="n">String</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">String</span> <span class="n">msg</span> <span class="o">=</span> <span class="o">(</span><span class="n">String</span><span class="o">)</span><span class="n">message</span><span class="o">;</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">msg</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">&quot;Hello&quot;</span><span class="o">))</span> <span class="o">{</span>
      <span class="c1">// Reply to original sender of message using the &#39;replyUnsafe&#39; method</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">getContext</span><span class="o">().</span><span class="na">replySafe</span><span class="o">(</span><span class="n">msg</span> <span class="o">+</span> <span class="s">&quot; from &quot;</span> <span class="o">+</span> <span class="n">getContext</span><span class="o">().</span><span class="na">getUuid</span><span class="o">()))</span> <span class="o">...</span> <span class="c1">// success</span>
      <span class="k">else</span> <span class="o">...</span> <span class="c1">// handle failure</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="summary-of-reply-semantics-and-options">
<h3><a class="toc-backref" href="#id16">Summary of reply semantics and options</a><a class="headerlink" href="#summary-of-reply-semantics-and-options" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">getContext().reply(...)</span></tt> can be used to reply to an <tt class="docutils literal"><span class="pre">Actor</span></tt> or a
<tt class="docutils literal"><span class="pre">Future</span></tt> from within an actor; the current actor will be passed as reply
channel if the current channel supports this.</li>
<li><tt class="docutils literal"><span class="pre">getContext().channel</span></tt> is a reference providing an abstraction for the
reply channel; this reference may be passed to other actors or used by
non-actor code.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>There used to be two methods for determining the sending Actor or Future for the current invocation:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">getContext().sender()</span></tt> yielded a <tt class="xref py py-class docutils literal"><span class="pre">Option[ActorRef]</span></tt></li>
<li><tt class="docutils literal"><span class="pre">getContext().senderFuture()</span></tt> yielded a <tt class="xref py py-class docutils literal"><span class="pre">Option[CompletableFuture[Any]]</span></tt></li>
</ul>
<p>These two concepts have been unified into the <tt class="docutils literal"><span class="pre">channel</span></tt>. If you need to
know the nature of the channel, you may do so using instance tests:</p>
<div class="last highlight-scala"><div class="highlight"><pre><span class="k">if</span> <span class="o">(</span><span class="n">getContext</span><span class="o">().</span><span class="n">channel</span><span class="o">()</span> <span class="n">instanceof</span> <span class="nc">ActorRef</span><span class="o">)</span> <span class="o">{</span>
  <span class="o">...</span>
<span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">getContext</span><span class="o">().</span><span class="n">channel</span><span class="o">()</span> <span class="n">instanceof</span> <span class="nc">ActorCompletableFuture</span><span class="o">)</span> <span class="o">{</span>
  <span class="o">...</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="starting-actors">
<h2><a class="toc-backref" href="#id17">Starting actors</a><a class="headerlink" href="#starting-actors" title="Permalink to this headline">¶</a></h2>
<p>Actors are started by invoking the ‘start’ method.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">ActorRef</span> <span class="n">actor</span> <span class="o">=</span> <span class="n">actorOf</span><span class="o">(</span><span class="n">SampleUntypedActor</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="n">myActor</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
</pre></div>
</div>
<p>You can create and start the Actor in a one liner like this:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">ActorRef</span> <span class="n">actor</span> <span class="o">=</span> <span class="n">actorOf</span><span class="o">(</span><span class="n">SampleUntypedActor</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">start</span><span class="o">();</span>
</pre></div>
</div>
<p>When you start the actor then it will automatically call the &#8216;preStart&#8217; callback method on the &#8216;UntypedActor&#8217;. This is an excellent place to add initialization code for the actor.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="nd">@Override</span>
<span class="kt">void</span> <span class="nf">preStart</span><span class="o">()</span> <span class="o">{</span>
  <span class="o">...</span> <span class="c1">// initialization code</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="stopping-actors">
<h2><a class="toc-backref" href="#id18">Stopping actors</a><a class="headerlink" href="#stopping-actors" title="Permalink to this headline">¶</a></h2>
<p>Actors are stopped by invoking the ‘stop’ method.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">actor</span><span class="o">.</span><span class="na">stop</span><span class="o">();</span>
</pre></div>
</div>
<p>When stop is called then a call to the ‘postStop’ callback method will take place. The Actor can use this callback to implement shutdown behavior.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="nd">@Override</span>
<span class="kt">void</span> <span class="nf">postStop</span><span class="o">()</span> <span class="o">{</span>
  <span class="o">...</span> <span class="c1">// clean up resources</span>
<span class="o">}</span>
</pre></div>
</div>
<p>You can shut down all Actors in the system by invoking:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">Actors</span><span class="o">.</span><span class="na">registry</span><span class="o">().</span><span class="na">shutdownAll</span><span class="o">();</span>
</pre></div>
</div>
</div>
<div class="section" id="poisonpill">
<h2><a class="toc-backref" href="#id19">PoisonPill</a><a class="headerlink" href="#poisonpill" title="Permalink to this headline">¶</a></h2>
<p>You can also send an actor the akka.actor.PoisonPill message, which will stop the actor when the message is processed.
If the sender is a Future, the Future will be completed with an akka.actor.ActorKilledException(&#8220;PoisonPill&#8221;)</p>
<p>Use it like this:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">static</span> <span class="n">akka</span><span class="o">.</span><span class="na">actor</span><span class="o">.</span><span class="na">Actors</span><span class="o">.*;</span>

<span class="n">actor</span><span class="o">.</span><span class="na">tell</span><span class="o">(</span><span class="n">poisonPill</span><span class="o">());</span>
</pre></div>
</div>
</div>
<div class="section" id="killing-an-actor">
<h2><a class="toc-backref" href="#id20">Killing an Actor</a><a class="headerlink" href="#killing-an-actor" title="Permalink to this headline">¶</a></h2>
<p>You can kill an actor by sending a &#8216;new Kill()&#8217; message. This will restart the actor through regular supervisor semantics.</p>
<p>Use it like this:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">static</span> <span class="n">akka</span><span class="o">.</span><span class="na">actor</span><span class="o">.</span><span class="na">Actors</span><span class="o">.*;</span>

<span class="c1">// kill the actor called &#39;victim&#39;</span>
 <span class="n">victim</span><span class="o">.</span><span class="na">tell</span><span class="o">(</span><span class="n">kill</span><span class="o">());</span>
</pre></div>
</div>
</div>
<div class="section" id="actor-life-cycle">
<h2><a class="toc-backref" href="#id21">Actor life-cycle</a><a class="headerlink" href="#actor-life-cycle" title="Permalink to this headline">¶</a></h2>
<p>The actor has a well-defined non-circular life-cycle.</p>
<div class="highlight-scala"><pre>NEW (newly created actor) - can't receive messages (yet)
    =&gt; STARTED (when 'start' is invoked) - can receive messages
        =&gt; SHUT DOWN (when 'exit' or 'stop' is invoked) - can't do anything</pre>
</div>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="index.html">Java API</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="typed-actors.html">Typed Actors (Java)</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2011, Typesafe Inc.
      Last updated on Sep 19, 2011.
    </div>
  </body>
</html>